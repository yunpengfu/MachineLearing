# 第4章 基于概率论的分类方法：朴素贝叶斯
贝叶斯分类是一类分类算法的总称，这类算法均以贝叶斯定理为基础，故统称为贝叶斯分类。本章首先介绍贝叶斯分类算法的基础——贝叶斯定理。  
* 贝叶斯理论
>假设我们现在有一个数据集，它由两类数据组成，数据分布如下图4-1所示：
>![数据分布](https://raw.githubusercontent.com/apachecn/AiLearning/master/img/ml/4.NaiveBayesian/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E7%A4%BA%E4%BE%8B%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83.png "数据分布")  
>我们现在用 p1(x,y) 表示数据点 (x,y) 属于类别 1（图中用圆点表示的类别）的概率，用 p2(x,y) 表示数据点 (x,y) 属于类别2图中三角形表示的类别）的概率，那么对于一个新数据点 (x,y)，可以用下面的规则来判断它的类别：
>* 如果 p1(x,y) > p2(x,y) ，那么类别为1；
>* 如果 p2(x,y) > p1(x,y) ，那么类别为2。  

>也就是说，我们会选择高概率对应的类别。这就是贝叶斯决策理论的核心思想，即选择具有最高概率的决策。
* 条件概率
>假设现在有一个装了7块石头的罐子，其中3块是白色的，4块是黑色的（如图4-2所示）。如果从罐子中随机取出一块石头，那么是白色石头的可能性是多少？由于取石头有7种可能，其中3种为白色，所以取出白色石头的概率为3/7 。那么取到黑色石头的概率又是多少呢？很显然，是4/7 。我们使用P(white)来表示取到白色石头的概率，其概率值可以通过白色石头数目除以总的石头数目来得到。  
>![石头分布](https://raw.githubusercontent.com/apachecn/AiLearning/master/img/ml/4.NaiveBayesian/NB_2.png "石头分布")  
>如果这7块石头如图4-3所示，放在两个桶中，那么上述概率应该如何计算？ 
>![石头分布2](https://raw.githubusercontent.com/apachecn/AiLearning/master/img/ml/4.NaiveBayesian/NB_3.png "石头分布2")  
>计算 P(white) 或者 P(black) ，如果事先我们知道石头所在桶的信息是会改变结果的。这就是所谓的条件概率（conditional probablity）。假定计算的是从B桶取到白色石头的概率，这个概率可以记作 P(white|bucketB) ，我们称之为“在已知石头出自B桶的条件下，取出白色石头的概率”。很容易得到，P(white|bucketA) 值为2/4 ，P(white|bucketB) 的值为1/3 。  
>条件概率的计算公式如下：
>>P(white|bucketB) = P(white and bucketB) / P(bucketB)  

>首先，我们用B桶中白色石头的个数除以两个桶中总的石头数，得到P(white and bucketB) = 1/7。其次，由 B桶中有3块石头，而总石头数为 7 ，于是 P(bucketB) 就等于3/7 。于是又 P(white|bucketB) = P(white and bucketB) / P(bucketB) = (1/7) / (3/7) = 1/3 。  
>另外一种有效计算条件概率的方法称为贝叶斯准则。贝叶斯准则告诉我们如何交换条件概率中的条件与结果，即如果已知P(x|c)，要求P(c|x)，那么可以使用下面的计算方法：
>>![计算方法](https://raw.githubusercontent.com/apachecn/AiLearning/master/img/ml/4.NaiveBayesian/NB_4.png "计算方法")  

## 朴素贝叶斯 原理
```
提取所有文档中的词条并进行去重
获取文档的所有类别
计算每个类别中的文档数目
对每篇训练文档: 
    对每个类别: 
        如果词条出现在文档中-->增加该词条的计数值（for循环或者矩阵相加）
        增加所有词条的计数值（此类别下词条总数）
对每个类别: 
    对每个词条: 
        将该词条的数目除以总词条数目得到的条件概率（P(词条|类别)）
返回该文档属于每个类别的条件概率（P(类别|文档的所有词条)）
```
### 朴素贝叶斯 算法特点
优点: 在数据较少的情况下仍然有效，可以处理多类别问题。  
缺点: 对于输入数据的准备方式较为敏感。  
适用数据类型: 标称型数据。  
### 朴素贝叶斯 开发流程
收集数据: 可以使用任何方法。  
准备数据: 需要数值型或者布尔型数据。  
分析数据: 有大量特征时，绘制特征作用不大，此时使用直方图效果更好。  
训练算法: 计算不同的独立特征的条件概率。  
测试算法: 计算错误率。  
使用算法: 一个常见的朴素贝叶斯应用是文档分类。可以在任意的分类场景中使用朴素贝叶斯分类器，不一定非要是文本。  


